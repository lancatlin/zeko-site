<!DOCTYPE html>
<html lang="zh"><head>
    <meta charset="UTF-8">
    <title>我棄用了 Funkwhale 並蓋了自己的音樂網站 - 林貓 Zeko Lin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="" />

    <meta property="og:title" content="我棄用了 Funkwhale 並蓋了自己的音樂網站" />
    <meta property="og:description" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://zeko.studio/blog/build-a-music-site/" />
    <meta itemprop="name" content="我棄用了 Funkwhale 並蓋了自己的音樂網站">
    <meta itemprop="description" content="">
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="我棄用了 Funkwhale 並蓋了自己的音樂網站"/>
    <meta name="twitter:description" content=""/>

    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png">

    
    <link rel="stylesheet" href="https://zeko.studio/scss/style.min.83399b0d247f8002bbe149eb1cdf9a3c2b53b945e293bc110a10e3c6475ad00e.css" >
    
<script type="text/javascript">
  var _paq = window._paq = window._paq || [];
   
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//matomo.linchpins.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '5']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>

</head>
<body>
    <header>
	<div class="header header-frame">
		<div>
			<div class="header__title ">
				<a href="/">林貓 Zeko Lin</a>
			</div>
			
				<div class="header__description">歡迎你來到這裡！</div>
			
		</div>
		<nav class="header-nav">
			<ul class="header-nav-list header-nav-list--menu">
				
				
                    <li class="header-nav-list__item">
                        <a class="header-nav-list__link" href="/blog/">
                            
                            <span>Blog</span>
                        </a>
                    </li>
				
                    <li class="header-nav-list__item">
                        <a class="header-nav-list__link" href="https://streetvoice.com/zeko">
                            
                            <span>StreetVoice</span>
                        </a>
                    </li>
				
                    <li class="header-nav-list__item">
                        <a class="header-nav-list__link" href="https://odysee.com/@zeko:b">
                            
                            <span>LBRY/Odysee</span>
                        </a>
                    </li>
				
                    <li class="header-nav-list__item">
                        <a class="header-nav-list__link" href="/about/">
                            
                            <span>About</span>
                        </a>
                    </li>
				
				<li class="header-nav-list__item">
					<a href="/index.xml">
						<img src="/icon/rss.svg" height=16px>
					</a>
				</li>
			</ul>
		</nav>
		
			
				<a aria-label="burger menu" href="#mobile-header-nav" class="mb-header__menu-btn">
					<span class="mb-header__menu-btn-line"></span>
					<span class="mb-header__menu-btn-line"></span>
					<span class="mb-header__menu-btn-line"></span>
				</a>
			
		
	</div>
	<nav id="mobile-header-nav" class="mb-header-nav">
  
  
  <a href="#" class="mb-header-nav__close-btn">
    <svg
            class="mb-header-nav__svg-icon"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            width="32"
            height="32"
            >
            <path
                d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                />
            <path d="M0 0h24v24H0z" fill="none" />
        </svg>
  </a>
  
    <div class="mb-header-nav__wrapper">
        <div class="mb-header-nav__container">
            <svg
                width="240"
                height="72"
                viewBox="0 0 240 72"
                class="mb-header-nav__title"
                >
                <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">
                Menu
                </text>
            </svg>
            <ul class="mb-header-nav-list">
                
                
                    
                        <li class="mb-header-nav-list__item  cssonly ">
                            <a class="mb-header-nav-list__link" href="/blog/">
                                Blog
                            </a>
                        </li>
                    
                
                    
                        <li class="mb-header-nav-list__item  cssonly ">
                            <a class="mb-header-nav-list__link" href="https://streetvoice.com/zeko">
                                StreetVoice
                            </a>
                        </li>
                    
                
                    
                        <li class="mb-header-nav-list__item  cssonly ">
                            <a class="mb-header-nav-list__link" href="https://odysee.com/@zeko:b">
                                LBRY/Odysee
                            </a>
                        </li>
                    
                
                    
                        <li class="mb-header-nav-list__item  cssonly ">
                            <a class="mb-header-nav-list__link" href="/about/">
                                About
                            </a>
                        </li>
                    
                
                <li class="mb-header-nav-list__item cssonly">
					<a href="/index.xml" class="mb-header-nav-list__link">
						<img src="/icon/rss.svg" height=30px>
						RSS
					</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

</header>


    <div id="content">
<article class="post">
  <div class="post-content">
  <h1 >我棄用了 Funkwhale 並蓋了自己的音樂網站</h1>
</div>
  
    <div class="post-content"><p>這個網站剛創立的時候，我架了自由的音樂平台 <a href="https://funkwhale.audio/">FunkWhale</a> 來發佈我的音樂。FunkWhale 是我目前找到唯一比較面向創作者的音樂平台，而且支援 ActivityPub 這個聯邦式協議，也就是說別的 FunkWhale 站點可以聽到我網站上的音樂（反之亦是），到目前看來都非常理想。我在安裝時，由於是比較複雜的反向代理環境，遇到了很多困難，但我最後仍一一克服了。</p>
<p>FunkWhale 最大的問題是<strong>它超級慢～～</strong>，FunkWhale 是用 Django 寫的，本來體質就特肥，而且又有一堆我其實不需要的「功能」，每次上傳一首歌就在後台跑一堆轉碼處理，然後等幾個小時都不會好，得要重開機才行，而且網頁載入也超慢，打開首頁可能就要等個 5、6 秒。它的嵌入播放器也一樣，網頁打開後還要等個 5、6 秒才能播音樂，而且 FunkWhale 填歌曲資料的地方很難用，沒辦法用單行的斷行，這讓歌詞被排版的很醜。</p>
<p>我開始尋找 FunkWhale 的替代品，驚訝的發現，幾乎所有 Self-Hosted Music Streaming 的軟體都是設計給「音樂收藏者」而非創作者，意思是會買專輯、收集自己愛聽的音樂（這麼做很好），而不只是用串流媒體的人（串流媒體的音樂不是你的音樂）。這些軟體都很不錯，我自己改天應該也會架一個，但就不符合我發佈音樂的需求。</p>
<p>正當我快絕望，打算自己寫一個（？）的時候，我突然想到：為何不直接把音樂放在我的網站裡？就是字面上的意思，把音檔放在網站上，直接傳到瀏覽器播放，不用什麼愚蠢的資料庫和肥大的前後端，歌曲的資料直接寫在網站裡（而且有好看的排版）。我直接用網頁標準裡的 &lt;video&gt; 來播放音檔，不需要任何 <del>stupid</del> JavaScript。由於無損壓縮 FLAC 沒有被瀏覽器廣泛支援，WAV 又真的太大，OGG 某些瀏覽器不支援（Safari），我最後還是選擇比較通用的 MP3 格式。</p>
<p>我寫了一個 <a href="https://gohugo.io/templates/shortcode-templates/">Hugo Shortcode</a> 用來放音樂播放器，同時還有下載、嵌入按鈕，Shortcode 播放器部分內容如下（按鈕比較冗長這篇先不寫，也不包含所有 styling 的內容）：</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#998;font-style:italic">&lt;!-- layouts/shortcodes/audio.html --&gt;</span>
&lt;<span style="color:#000080">div</span> <span style="color:#008080">align</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;center&#34;</span>&gt;
  &lt;<span style="color:#000080">video</span>
    <span style="color:#008080">controls</span>
    <span style="color:#008080">poster</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;/img/{{ with .Get &#34;cover&#34; }}{{ . }}{{ else }}cover.jpg{{ end }}&#39;</span>
  &gt;
    &lt;<span style="color:#000080">source</span> <span style="color:#008080">src</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;/music/{{ .Get &#34;src&#34; }}&#39;</span> <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;audio/mpeg&#34;</span> /&gt;
  &lt;/<span style="color:#000080">video</span>&gt;
&lt;/<span style="color:#000080">div</span>&gt;
</code></pre></div><p>把音檔放在 /static/music 資料夾，封面放 /static/img 資料夾，只要在文章裡寫：</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">{{&lt; <span style="color:#000080">audio</span> <span style="color:#008080">src</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">Reborn.mp3</span> <span style="color:#008080">cover</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">Reborn.jpg</span> &gt;}}
</code></pre></div><p>就能得到：</p>
<style>
    .dropdown {
        position: relative;
        display: inline-block;
    }
    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f1f1f1;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        z-index: 1;
    }

    .dropdown:hover .dropdown-content {display: block;}

</style>
<div align="center" class="audio-container">
    <video controls poster='/img/Reborn.jpg' class="responsive-iframe">
        <source src='/music/Reborn.mp3' type="audio/mpeg">
    </video>
</div>
<div align="center" style="margin-top: 5px;">
    <a href='/music/Reborn.mp3' style="border-bottom: none; margin-right: 5px;" download>
        <img src=/icon/download.svg height="40px">
    </a>
    <div class="dropdown">
        <img src='/icon/embed.svg' height="40px">
        <div class="dropdown-content">
            <p>Paste this code to your website.</p>
            <textarea rows="6" cols=60>&lt;div align="center">
    &lt;video controls poster='https://zeko.studio/img/Reborn.jpg'>
    &lt;source src='https://zeko.studio/music/Reborn.mp3' type="audio/mpeg">
&lt;/video>
&lt;p>Music by &lt;a href=https://zeko.studio>Zeko.Studio&lt;/a>&lt;/p>&lt;/div></textarea>
        </div>
    </div>
</div>
<p>如果不提供 cover 就會帶入預設的 cover.jpg。</p>
<p>HTML 內建播放器載入超爆快超好用，我之前竟然用一堆又複雜又慢的程式，而根本不知道有這個好東西可以用。解決問題時真的是愈簡單的作法愈好啊！</p>
</div>
  
</article>
<button class="floating-button">
    <a class="floating-button__link" href="https://zeko.studio">
        <span>Home</span>
    </a>
</button>


    </div>
    
    <footer class="post-footer">
    <div class="footer">
        
            <div>© 2021, Zeko Lin</div>
        
        <div class="footer__socials">










</div>
    </div>
</footer>


    
    
      
    
  </body>
</html>
